DROP MATERIALIZED VIEW AVALUOS.V_AVALUOS_ARGIS;
CREATE MATERIALIZED VIEW AVALUOS.V_AVALUOS_ARGIS
REFRESH FORCE ON DEMAND
AS
SELECT PGB_AVA.ID_AVALUO,
  PGB_AVA.F_FECHAAVALUO,
  PGB_AVA.N_IDENTIFICACION,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_ciudades(PGB_AVA.C_IDCIUDAD),1,60) C_IDCIUDAD,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_departamentos(PGB_AVA.C_IDDEPARTAMENTO),1,60) C_IDDEPARTAMENTO,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_AVA.C_IDTIPOIDENTIFICACION,'TIPOIDENTIFICACION'),1,20) C_IDTIPOIDENTIFICACION,
  PGB_AVA.T_BARRIO,
  PGB_AVA.T_DIRINMUEBLE,
  PGB_AVA.T_NOMBCONJEDIF,
  PGB_AVA.T_NOMBRESOLICITANTE,
  PGB_AVA.A_SOLTEL,
  PGB_AVA.A_SOLCEL,
  --09 Abr 2014: Circular 11
  PGB_AVA.T_LATITUD,
  --09 Abr 2014: Circular 11
  PGB_AVA.t_Longitud,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_AVA.T_SECTOR,'SECTOR'),1,20) T_SECTOR,
  PGB_AVA.A_SOLCORREO,
  SUBSTR(DECODE(PGB_CS.K_INSERGURIDAD,1,'Si',0,'No'),1,2) K_INSERGURIDAD,
  SUBSTR(DECODE(PGB_IB.K_ALAMEDAS,1,'Si',0,'No'),1,2) K_ALAMEDAS,
  SUBSTR(DECODE(PGB_IB.K_ALUMBRADO,1,'Si',0,'No'),1,2) K_ALUMBRADO,
  SUBSTR(DECODE(PGB_IB.K_ARBORIZACION,1,'Si',0,'No'),1,2) K_ARBORIZACION,
  SUBSTR(DECODE(PGB_IB.K_CICLORUTAS,1,'Si',0,'No'),1,2) K_CICLORUTAS,
  SUBSTR(DECODE(PGB_IB.K_PARADERO,1,'Si',0,'No'),1,2) K_PARADERO,
  SUBSTR(DECODE(PGB_IB.K_PARQUES,1,'Si',0,'No'),1,2) K_PARQUES,
  SUBSTR(DECODE(PGB_IB.K_ZONASVERDES,1,'Si',0,'No'),1,2) K_ZONASVERDES,
  SUBSTR(DECODE(PGB_IB.K_ACUEDUCTOPREDIO,1,'Si',0,'No'),1,2) K_ACUEDUCTOPREDIO,
  SUBSTR(DECODE(PGB_IB.K_ACUEDUCTOSECTOR,1,'Si',0,'No'),1,2) K_ACUEDUCTOSECTOR,
  SUBSTR(DECODE(PGB_IB.K_ALCANTAPREDIO,1,'Si',0,'No'),1,2) K_ALCANTAPREDIO,
  SUBSTR(DECODE(PGB_IB.K_ALCANTASECTOR,1,'Si',0,'No'),1,2) K_ALCANTASECTOR,
  SUBSTR(DECODE(PGB_IB.K_ELECTRICAPREDIO,1,'Si',0,'No'),1,2) K_ELECTRICAPREDIO,
  SUBSTR(DECODE(PGB_IB.K_ELECTRICASECTOR,1,'Si',0,'No'),1,2) K_ELECTRICASECTOR,
  SUBSTR(DECODE(PGB_IB.K_GASPREDIO,1,'Si',0,'No'),1,2) K_GASPREDIO,
  SUBSTR(DECODE(PGB_IB.K_GASSECTOR,1,'Si',0,'No'),1,2) K_GASSECTOR,
  SUBSTR(DECODE(PGB_IB.K_TELPREDIO,1,'Si',0,'No'),1,2) K_TELPREDIO,
  SUBSTR(DECODE(PGB_IB.K_TELSECTOR,1,'Si',0,'No'),1,2) K_TELSECTOR,
  SUBSTR(DECODE(PGB_IB.K_COMERCIO,1,'Si',0,'No'),1,2) K_COMERCIO,
  SUBSTR(DECODE(PGB_IB.K_INDUSTRIA,1,'Si',0,'No'),1,2) K_INDUSTRIA,
  SUBSTR(DECODE(PGB_IB.K_OTROSUSOS,1,'Si',0,'No'),1,2) K_OTROSUSOS,
  SUBSTR(DECODE(PGB_IB.K_VIVIENDA,1,'Si',0,'No'),1,2) K_VIVIENDA,
  PGB_IB.T_OTROSUSOS,
  SUBSTR(PKG_GENERAL_AVALUOS.SF_DOMINIOS(PGB_IB.C_ANDENES,'AFIRMAR'),1,2) C_ANDENES,
  SUBSTR(PKG_GENERAL_AVALUOS.SF_DOMINIOS(PGB_IB.C_ESTVIAACCESO,'MBR'),1,40) C_ESTVIAACCESO,
  SUBSTR(PKG_GENERAL_AVALUOS.SF_DOMINIOS(PGB_IB.C_PAVIMENTADA,'AFIRMAR'),1,2)C_PAVIMENTADA ,
  SUBSTR(PKG_GENERAL_AVALUOS.SF_DOMINIOS(PGB_IB.C_SARDENELES,'AFIRMAR'),1,2) C_SARDENELES,
  SUBSTR(PKG_GENERAL_AVALUOS.SF_DOMINIOS(PGB_IB.C_ESTRATO,'ESTRATO'),1,40)C_ESTRATO,
  SUBSTR(PKG_GENERAL_AVALUOS.SF_DOMINIOS(PGB_IB.C_LEGALIDAD,'LEGALBARRIO'),1,40) C_LEGALIDAD,
  SUBSTR(PKG_GENERAL_AVALUOS.SF_DOMINIOS(PGB_IB.C_TOPOGRAFIA,'TOPOGRAFIA'),1,40) C_TOPOGRAFIA,
  SUBSTR(PKG_GENERAL_AVALUOS.SF_DOMINIOS(PGB_IB.C_TRANSPORTE,'MBR'),1,40) C_TRANSPORTE,
  PGB_IB.T_PERSPECTIVAS,
  PGB_IB.A_EDIIGUALES,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.C_ESTTECHOS,'INFOCONSTR'),1,40) C_ESTTECHOS,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.C_PISOSBODEGA,'PISOSBODEGA'),1,40) C_PISOSBODEGA,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.C_TIPOFACHADA,'TIPOFACHADA'),1,40) C_TIPOFACHADA,
  PGB_IC.N_COCINA,
  PGB_IC.N_CUARTOSERV,
  PGB_IC.N_JARDIN,
  PGB_IC.N_OFICINA,
  PGB_IC.N_PRIVADO,
  PGB_IC.N_TERRAZA,
  PGB_IC.N_TOTALGARAJES,
  PGB_IC.N_USOEXCLUSiVO,
  PGB_IC.N_ZVERDEPRIV,
  PGB_IC.T_AVANCEOBRA,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.C_ESTCONSERVACION,'ESTADOCONSERVACION'),1,40) C_ESTCONSERVACION,
  SUBSTR(DECODE(PGB_IC.K_ENoBRA,1,'Si',0,'No'),1,2) K_ENOBRA,
  SUBSTR(DECODE(PGB_IC.K_ESTREMODELA,1,'Si',0,'No'),1,2)K_ESTREMODELA,
  SUBSTR(DECODE(PGB_IC.K_ESTTERMINADA,1,'Si',0,'No'),1,2)K_ESTTERMINADA,
  SUBSTR(DECODE(PGB_IC.K_ESTTERMINADO,1,'Si',0,'No'),1,2)K_ESTTERMINADO,
  SUBSTR(DECODE(PGB_IC.K_SINTERMINAR,1,'Si',0,'No'),1,2)K_SINTERMINAR,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.R_ESTCONS,'ESTADOCONSERVACION'),1,40) R_ESTCONS,
  PGB_IC.N_NUMEDIF,
  PGB_IC.N_TOTALUND,
  PGB_IC.N_UNDPISO,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.C_CONJAGRUPCERR,'AFIRMAR'),1,40) C_CONJAGRUPCERR,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.C_UBICACIONINM,'UBICACION'),1,40) C_UBICACIONINM,
  PGB_IC.N_PISOS,
  PGB_IC.N_SOTANOS,
  PGB_IC.N_VETUSTEZ,
  --09 Abr 2014: Circular 11
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.A_RCONS_SF,'RANGO_CONSTRUCCION_SF'),1,40) A_RCONS_SF, 
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.C_CUBIERTA,'CUBIERTA'),1,40) C_CUBIERTA,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.C_ESTRUCTURA,'ESTRUCTURA'),1,40) C_ESTRUCTURA,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.C_FACHADA,'FACHADA'),1,40) C_FACHADA,
  PGB_IC.T_CUBIERTA,
  PGB_IC.T_ESTRUCTURA,
  PGB_IC.T_FACHADA,
  PGB_IC.A_EDIPISO,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.A_UBICFUENTESH,'AFIRMAR'),1,2) A_UBICFUENTESH,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.A_UBICNIVELZ,'NIVEL'),1,40) A_UBICNIVELZ,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.A_LUCES,'LUCES'),1,40) A_LUCES,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IF.A_EDICONSTUSO,'AFIRMAR'),1,40) A_EDICONSTUSO,
 --09 Abr 2014: Circular 11
 SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.SIMETRIA_ALT_SF,'SIMETRIA_SF'),1,40) SIMETRIA_ALT_SF,
 SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.SIMETRIA_PLANT_SF,'SIMETRIA_SF'),1,40) SIMETRIA_PLANT_SF,
 SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.C_MATERIAL_SF,'C_MATERIAL_SF'),1,40) C_MATERIAL_SF,
 SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.c_Detallematerial,'C_ESTRUCTURA_SF_BUA'),1,40) c_Detallematerial,
  --09 Abr 2014: Circular 11
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.A_DANOPREVIO_SF,'A_DANOPREVIO_SF'),1,40) A_DANOPREVIO_SF,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.A_DANOREPARADO_SF,'A_DANOREPARADO_SF'),1,40) A_DANOREPARADO_SF,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.C_ESTREFORZADA_SF,'A_REFORZADA_SF'),1,40) C_ESTREFORZADA_SF,
  PGB_IC.A_OTRO_MATERIAL,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.A_EDIPARAPET,'AFIRMAR'),1,40) A_EDIPARAPET,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.A_DCELEVTANQ,'TANQUES'),1,40) A_DCELEVTANQ,
  PGB_IC.A_OTRA_UBIC_TANQUE,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.A_SOBREPESO,'AFIRMAR'),1,2) SOBREPESO,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.A_GOLPETEO,'GOLPETEO'),1,40) A_GOLPETEO,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.A_ASENTAMIENTOS,'AFIRMAR'),1,2) ASENTAMIENTOS,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.A_DANoPREVIO,'DANOS'),1,40) A_DANOPREVIO,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IF.C_CLASEINMUEBLE,'CLASEINMUEBLE'),1,40)C_CLASEINMUEBLE,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IF.C_TIPOVIVIENDA,'TIPOVIVIENDA'),1,40) C_TIPOVIVIENDA,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IF.C_UBICACION2,'UBICACION2'),1,40) C_UBICACION2,
  --09 Abr 2014: Circular 11
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IF.C_USOINMUEBLE_SF,'C_USOINMUEBLE_SF'),1,40) C_USOINMUEBLE_SF,
  PGB_IF.T_CHIP,
  --09 Abr 2014: Circular 11
  PGB_IF.T_CATASTRAL_SF,
  PGB_IF.T_MINMBPPAL1,
  PGB_IF.T_MINMOBDP1,
  PGB_IF.T_MINMOBGJ1,
  PGB_IF.T_OTROCLASE,
  PGB_IF.T_OTROUSOINM,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.C_ALTURA,'ALTURA'),1,40)C_ALTURA,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IF.C_UBICACION3,'UBICACION3'),1,40) C_UBICACION3,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IF.IDCATEGORIA,'CATEGORIA'),1,40) IDCATEGORIA,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_LIQ.C_DESCRIPLIQ,'DESCLIQUIDACION'),1,40) C_DESCRIPLIQ1,
  PGB_LIQ.N_AREALIQ N_AREALIQ1,
  PGB_LIQ.N_VAL NVAL1,
  PGB_LIQ.N_VALTOT N_VALTOT1,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_descrip_avaluo(PGB_AVA.ID_AVALUO,2),1,40) C_DESCRIPLIQ2,
  PKG_GENERAL_AVALUOS.sf_area_avaluo(PGB_AVA.ID_AVALUO,2) N_AREALIQ2,
  PKG_GENERAL_AVALUOS.sf_valor_unitario(PGB_AVA.ID_AVALUO,2) NVAL2,
  PKG_GENERAL_AVALUOS.sf_valor_total(PGB_AVA.ID_AVALUO,2) N_VALTOT2,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_descrip_avaluo(PGB_AVA.ID_AVALUO,3),1,40) C_DESCRIPLIQ3,
  PKG_GENERAL_AVALUOS.sf_area_avaluo(PGB_AVA.ID_AVALUO,3) N_AREALIQ3,
  PKG_GENERAL_AVALUOS.sf_valor_unitario(PGB_AVA.ID_AVALUO,3) NVAL3,
  PKG_GENERAL_AVALUOS.sf_valor_total(PGB_AVA.ID_AVALUO,3) N_VALTOT3,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_descrip_avaluo(PGB_AVA.ID_AVALUO,4),1,40) C_DESCRIPLIQ4,
  PKG_GENERAL_AVALUOS.sf_area_avaluo(PGB_AVA.ID_AVALUO,4) N_AREALIQ4,
  PKG_GENERAL_AVALUOS.sf_valor_unitario(PGB_AVA.ID_AVALUO,4) NVAL4,
  PKG_GENERAL_AVALUOS.sf_valor_total(PGB_AVA.ID_AVALUO,4) N_VALTOT4,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_descrip_avaluo(PGB_AVA.ID_AVALUO,5),1,40) C_DESCRIPLIQ5,
  PKG_GENERAL_AVALUOS.sf_area_avaluo(PGB_AVA.ID_AVALUO,5) N_AREALIQ5,
  PKG_GENERAL_AVALUOS.sf_valor_unitario(PGB_AVA.ID_AVALUO,5) NVAL5,
  PKG_GENERAL_AVALUOS.sf_valor_total(PGB_AVA.ID_AVALUO,5) N_VALTOT5,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_descrip_avaluo(PGB_AVA.ID_AVALUO,6),1,40) C_DESCRIPLIQ6,
  PKG_GENERAL_AVALUOS.sf_area_avaluo(PGB_AVA.ID_AVALUO,6) N_AREALIQ6,
  PKG_GENERAL_AVALUOS.sf_valor_unitario(PGB_AVA.ID_AVALUO,6) NVAL6,
  PKG_GENERAL_AVALUOS.sf_valor_total(PGB_AVA.ID_AVALUO,6) N_VALTOT6,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_descrip_avaluo(PGB_AVA.ID_AVALUO,7),1,40) C_DESCRIPLIQ7,
  PKG_GENERAL_AVALUOS.sf_area_avaluo(PGB_AVA.ID_AVALUO,7) N_AREALIQ7,
  PKG_GENERAL_AVALUOS.sf_valor_unitario(PGB_AVA.ID_AVALUO,7) NVAL7,
  PKG_GENERAL_AVALUOS.sf_valor_total(PGB_AVA.ID_AVALUO,7) N_VALTOT7,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_descrip_avaluo(PGB_AVA.ID_AVALUO,8),1,40) C_DESCRIPLIQ8,
  PKG_GENERAL_AVALUOS.sf_area_avaluo(PGB_AVA.ID_AVALUO,8) N_AREALIQ8,
  PKG_GENERAL_AVALUOS.sf_valor_unitario(PGB_AVA.ID_AVALUO,8) NVAL8,
  PKG_GENERAL_AVALUOS.sf_valor_total(PGB_AVA.ID_AVALUO,8) N_VALTOT8,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_descrip_avaluo(PGB_AVA.ID_AVALUO,9),1,40) C_DESCRIPLIQ9,
  PKG_GENERAL_AVALUOS.sf_area_avaluo(PGB_AVA.ID_AVALUO,9) N_AREALIQ9,
  PKG_GENERAL_AVALUOS.sf_valor_unitario(PGB_AVA.ID_AVALUO,9) NVAL9,
  PKG_GENERAL_AVALUOS.sf_valor_total(PGB_AVA.ID_AVALUO,9) N_VALTOT9,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_descrip_avaluo(PGB_AVA.ID_AVALUO,10),1,40) C_DESCRIPLIQ10,
  PKG_GENERAL_AVALUOS.sf_area_avaluo(PGB_AVA.ID_AVALUO,10) N_AREALIQ10,
  PKG_GENERAL_AVALUOS.sf_valor_unitario(PGB_AVA.ID_AVALUO,10) NVAL10,
  PKG_GENERAL_AVALUOS.sf_valor_total(PGB_AVA.ID_AVALUO,10) N_VALTOT10,
  PGB_LIQ_T.N_TOTALAVALUO,
  PGB_LIQ_T.N_VALORASEGURABLE,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_LIQ_T.R_CALIFICACION,'CALGARANTIA'),1,40) R_CALIFICACION,
  PGB_OBS.T_OBSERVAVALUO,
  PGB_OBS.T_OTRASDIR,
  DECODE(PGB_AVA.A_TIPO_INFORME,2,'SI','NO') AVALUO_CONSTRUCTOR,
  PGB_AVA.T_USUARIO ID_PERITO
  --09 Abr 2014: Circular 11
  ,PGB_IC.A_RCONS_SF A_RCONS_SF_COD
  ,PGB_IC.A_DANOPREVIO_SF A_DANOPREVIO_SF_COD
  ,PGB_IC.C_ESTREFORZADA_SF C_ESTREFORZADA_SF_COD
  ,PGB_IC.A_DANOREPARADO_SF A_DANOREPARADO_SF_COD
  ,PGB_IC.SIMETRIA_ALT_SF SIMETRIA_ALT_SF_COD
  ,PGB_IC.SIMETRIA_PLANT_SF SIMETRIA_PLANT_SF_COD
  ,PGB_IC.C_MATERIAL_SF C_MATERIAL_SF_COD
  ,PGB_IC.C_DETALLEMATERIAL C_DETALLEMATERIAL_COD
  ,PGB_IF.C_USOINMUEBLE_SF C_USOINMUEBLE_SF_COD
FROM PGB_AVALUOS PGB_AVA,
     PGB_CONDSALUBRIDAD PGB_CS,
     PGB_INFBARRIO PGB_IB,
     PGB_INFCONSTRUCCION PGB_IC,
     PGB_INFINMUEBLE PGB_IF,
     PGB_LIQAVALUO PGB_LIQ,
     (select min(consecutivo) consecutivo,id_avaluo from pgb_liqavaluo group by id_avaluo) Liquidaciones,
     PGB_LIQAVALUO_TOTAL PGB_LIQ_T,
     PGB_OBSERVACIONES PGB_OBS
WHERE PGB_AVA.ID_AVALUO = PGB_CS.ID_AVALUO
  AND PGB_CS.ID_AVALUO = PGB_IB.ID_AVALUO
  AND PGB_IB.ID_AVALUO = PGB_IC.ID_AVALUO
  AND PGB_IC.ID_AVALUO = PGB_IF.ID_AVALUO
  AND PGB_IF.ID_AVALUO = PGB_LIQ.ID_AVALUO
  AND PGB_LIQ.ID_AVALUO = PGB_LIQ_T.ID_AVALUO
  AND PGB_LIQ_T.ID_AVALUO = PGB_OBS.ID_AVALUO
  AND PGB_LIQ.CONSECUTIVO = Liquidaciones.consecutivo
  AND PGB_LIQ.ID_AVALUO = Liquidaciones.ID_AVALUO
  AND PGB_AVA.A_ESTADOAVALUO = 3
UNION
SELECT PGB_AVA.ID_AVALUO,
  PGB_AVA.F_FECHAAVALUO,
  PGB_AVA.N_IDENTIFICACION,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_ciudades(PGB_AVA.C_IDCIUDAD),1,60) C_IDCIUDAD,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_departamentos(PGB_AVA.C_IDDEPARTAMENTO),1,60) C_IDDEPARTAMENTO,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_AVA.C_IDTIPOIDENTIFICACION,'TIPOIDENTIFICACION'),1,20) C_IDTIPOIDENTIFICACION,
  PGB_AVA.T_BARRIO,
  PGB_AVA.T_DIRINMUEBLE,
  PGB_AVA.T_NOMBCONJEDIF,
  PGB_AVA.T_NOMBRESOLICITANTE,
  PGB_AVA.A_SOLTEL,
  PGB_AVA.A_SOLCEL,
  --09 Abr 2014: Circular 11
  PGB_AVA.T_LATITUD,
  --09 Abr 2014: Circular 11
  PGB_AVA.t_Longitud,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_AVA.T_SECTOR,'SECTOR'),1,20) T_SECTOR,
  PGB_AVA.A_SOLCORREO,
  SUBSTR(DECODE(PGB_CS.K_INSERGURIDAD,1,'Si',0,'No'),1,2) K_INSERGURIDAD,
  SUBSTR(DECODE(PGB_IB.K_ALAMEDAS,1,'Si',0,'No'),1,2) K_ALAMEDAS,
  SUBSTR(DECODE(PGB_IB.K_ALUMBRADO,1,'Si',0,'No'),1,2) K_ALUMBRADO,
  SUBSTR(DECODE(PGB_IB.K_ARBORIZACION,1,'Si',0,'No'),1,2) K_ARBORIZACION,
  SUBSTR(DECODE(PGB_IB.K_CICLORUTAS,1,'Si',0,'No'),1,2) K_CICLORUTAS,
  SUBSTR(DECODE(PGB_IB.K_PARADERO,1,'Si',0,'No'),1,2) K_PARADERO,
  SUBSTR(DECODE(PGB_IB.K_PARQUES,1,'Si',0,'No'),1,2) K_PARQUES,
  SUBSTR(DECODE(PGB_IB.K_ZONASVERDES,1,'Si',0,'No'),1,2) K_ZONASVERDES,
  SUBSTR(DECODE(PGB_IB.K_ACUEDUCTOPREDIO,1,'Si',0,'No'),1,2) K_ACUEDUCTOPREDIO,
  SUBSTR(DECODE(PGB_IB.K_ACUEDUCTOSECTOR,1,'Si',0,'No'),1,2) K_ACUEDUCTOSECTOR,
  SUBSTR(DECODE(PGB_IB.K_ALCANTAPREDIO,1,'Si',0,'No'),1,2) K_ALCANTAPREDIO,
  SUBSTR(DECODE(PGB_IB.K_ALCANTASECTOR,1,'Si',0,'No'),1,2) K_ALCANTASECTOR,
  SUBSTR(DECODE(PGB_IB.K_ELECTRICAPREDIO,1,'Si',0,'No'),1,2) K_ELECTRICAPREDIO,
  SUBSTR(DECODE(PGB_IB.K_ELECTRICASECTOR,1,'Si',0,'No'),1,2) K_ELECTRICASECTOR,
  SUBSTR(DECODE(PGB_IB.K_GASPREDIO,1,'Si',0,'No'),1,2) K_GASPREDIO,
  SUBSTR(DECODE(PGB_IB.K_GASSECTOR,1,'Si',0,'No'),1,2) K_GASSECTOR,
  SUBSTR(DECODE(PGB_IB.K_TELPREDIO,1,'Si',0,'No'),1,2) K_TELPREDIO,
  SUBSTR(DECODE(PGB_IB.K_TELSECTOR,1,'Si',0,'No'),1,2) K_TELSECTOR,
  SUBSTR(DECODE(PGB_IB.K_COMERCIO,1,'Si',0,'No'),1,2) K_COMERCIO,
  SUBSTR(DECODE(PGB_IB.K_INDUSTRIA,1,'Si',0,'No'),1,2) K_INDUSTRIA,
  SUBSTR(DECODE(PGB_IB.K_OTROSUSOS,1,'Si',0,'No'),1,2) K_OTROSUSOS,
  SUBSTR(DECODE(PGB_IB.K_VIVIENDA,1,'Si',0,'No'),1,2) K_VIVIENDA,
  PGB_IB.T_OTROSUSOS,
  SUBSTR(PKG_GENERAL_AVALUOS.SF_DOMINIOS(PGB_IB.C_ANDENES,'AFIRMAR'),1,2) C_ANDENES,
  SUBSTR(PKG_GENERAL_AVALUOS.SF_DOMINIOS(PGB_IB.C_ESTVIAACCESO,'MBR'),1,40) C_ESTVIAACCESO,
  SUBSTR(PKG_GENERAL_AVALUOS.SF_DOMINIOS(PGB_IB.C_PAVIMENTADA,'AFIRMAR'),1,2)C_PAVIMENTADA ,
  SUBSTR(PKG_GENERAL_AVALUOS.SF_DOMINIOS(PGB_IB.C_SARDENELES,'AFIRMAR'),1,2) C_SARDENELES,
  SUBSTR(PKG_GENERAL_AVALUOS.SF_DOMINIOS(PGB_IB.C_ESTRATO,'ESTRATO'),1,40)C_ESTRATO,
  SUBSTR(PKG_GENERAL_AVALUOS.SF_DOMINIOS(PGB_IB.C_LEGALIDAD,'LEGALBARRIO'),1,40) C_LEGALIDAD,
  SUBSTR(PKG_GENERAL_AVALUOS.SF_DOMINIOS(PGB_IB.C_TOPOGRAFIA,'TOPOGRAFIA'),1,40) C_TOPOGRAFIA,
  SUBSTR(PKG_GENERAL_AVALUOS.SF_DOMINIOS(PGB_IB.C_TRANSPORTE,'MBR'),1,40) C_TRANSPORTE,
  PGB_IB.T_PERSPECTIVAS,
  PGB_IB.A_EDIIGUALES,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.C_ESTTECHOS,'INFOCONSTR'),1,40) C_ESTTECHOS,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.C_PISOSBODEGA,'PISOSBODEGA'),1,40) C_PISOSBODEGA,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.C_TIPOFACHADA,'TIPOFACHADA'),1,40) C_TIPOFACHADA,
  PGB_IC.N_COCINA,
  PGB_IC.N_CUARTOSERV,
  PGB_IC.N_JARDIN,
  PGB_IC.N_OFICINA,
  PGB_IC.N_PRIVADO,
  PGB_IC.N_TERRAZA,
  PGB_IC.N_TOTALGARAJES,
  PGB_IC.N_USOEXCLUSiVO,
  PGB_IC.N_ZVERDEPRIV,
  PGB_IC.T_AVANCEOBRA,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.C_ESTCONSERVACION,'ESTADOCONSERVACION'),1,40) C_ESTCONSERVACION,
  SUBSTR(DECODE(PGB_IC.K_ENoBRA,1,'Si',0,'No'),1,2) K_ENOBRA,
  SUBSTR(DECODE(PGB_IC.K_ESTREMODELA,1,'Si',0,'No'),1,2)K_ESTREMODELA,
  SUBSTR(DECODE(PGB_IC.K_ESTTERMINADA,1,'Si',0,'No'),1,2)K_ESTTERMINADA,
  SUBSTR(DECODE(PGB_IC.K_ESTTERMINADO,1,'Si',0,'No'),1,2)K_ESTTERMINADO,
  SUBSTR(DECODE(PGB_IC.K_SINTERMINAR,1,'Si',0,'No'),1,2)K_SINTERMINAR,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.R_ESTCONS,'ESTADOCONSERVACION'),1,40) R_ESTCONS,
  PGB_IC.N_NUMEDIF,
  PGB_IC.N_TOTALUND,
  PGB_IC.N_UNDPISO,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.C_CONJAGRUPCERR,'AFIRMAR'),1,40) C_CONJAGRUPCERR,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.C_UBICACIONINM,'UBICACION'),1,40) C_UBICACIONINM,
  PGB_IC.N_PISOS,
  PGB_IC.N_SOTANOS,
  PGB_IC.N_VETUSTEZ,
  --09 Abr 2014: Circular 11
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.A_RCONS_SF,'RANGO_CONSTRUCCION_SF'),1,40) A_RCONS_SF, 
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.C_CUBIERTA,'CUBIERTA'),1,40) C_CUBIERTA,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.C_ESTRUCTURA,'ESTRUCTURA'),1,40) C_ESTRUCTURA,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.C_FACHADA,'FACHADA'),1,40) C_FACHADA,
  PGB_IC.T_CUBIERTA,
  PGB_IC.T_ESTRUCTURA,
  PGB_IC.T_FACHADA,
  PGB_IC.A_EDIPISO,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.A_UBICFUENTESH,'AFIRMAR'),1,2) A_UBICFUENTESH,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.A_UBICNIVELZ,'NIVEL'),1,40) A_UBICNIVELZ,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.A_LUCES,'LUCES'),1,40) A_LUCES,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IF.A_EDICONSTUSO,'AFIRMAR'),1,40) A_EDICONSTUSO,
 --09 Abr 2014: Circular 11
 SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.SIMETRIA_ALT_SF,'SIMETRIA_SF'),1,40) SIMETRIA_ALT_SF,
 SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.SIMETRIA_PLANT_SF,'SIMETRIA_SF'),1,40) SIMETRIA_PLANT_SF,
  --09 Abr 2014: Circular 11
 SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.C_MATERIAL_SF,'C_MATERIAL_SF'),1,40) C_MATERIAL_SF,
 SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.c_Detallematerial,'C_ESTRUCTURA_SF_BUA'),1,40) c_Detallematerial,
  --09 Abr 2014: Circular 11
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.A_DANOPREVIO_SF,'A_DANOPREVIO_SF'),1,40) A_DANOPREVIO_SF,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.A_DANOREPARADO_SF,'A_DANOREPARADO_SF'),1,40) A_DANOREPARADO_SF,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.C_ESTREFORZADA_SF,'A_REFORZADA_SF'),1,40) C_ESTREFORZADA_SF,
  PGB_IC.A_OTRO_MATERIAL,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.A_EDIPARAPET,'AFIRMAR'),1,40) A_EDIPARAPET,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.A_DCELEVTANQ,'TANQUES'),1,40) A_DCELEVTANQ,
  PGB_IC.A_OTRA_UBIC_TANQUE,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.A_SOBREPESO,'AFIRMAR'),1,2) SOBREPESO,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.A_GOLPETEO,'GOLPETEO'),1,40) A_GOLPETEO,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.A_ASENTAMIENTOS,'AFIRMAR'),1,2) ASENTAMIENTOS,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.A_DANoPREVIO,'DANOS'),1,40) A_DANOPREVIO,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IF.C_CLASEINMUEBLE,'CLASEINMUEBLE'),1,40)C_CLASEINMUEBLE,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IF.C_TIPOVIVIENDA,'TIPOVIVIENDA'),1,40) C_TIPOVIVIENDA,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IF.C_UBICACION2,'UBICACION2'),1,40) C_UBICACION2,
  --09 Abr 2014: Circular 11
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IF.C_USOINMUEBLE_SF,'C_USOINMUEBLE_SF'),1,40) C_USOINMUEBLE_SF,
  PGB_IF.T_CHIP,
  --09 Abr 2014: Circular 11
  PGB_IF.T_CATASTRAL_SF,
  PGB_IF.T_MINMBPPAL1,
  PGB_IF.T_MINMOBDP1,
  PGB_IF.T_MINMOBGJ1,
  PGB_IF.T_OTROCLASE,
  PGB_IF.T_OTROUSOINM,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IC.C_ALTURA,'ALTURA'),1,40)C_ALTURA,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IF.C_UBICACION3,'UBICACION3'),1,40) C_UBICACION3,
  SUBSTR(PKG_GENERAL_AVALUOS.sf_dominios(PGB_IF.IDCATEGORIA,'CATEGORIA'),1,40) IDCATEGORIA,
  NULL C_DESCRIPLIQ1,
  NULL N_AREALIQ1,
  NULL NVAL1,
  NULL N_VALTOT1,
  NULL C_DESCRIPLIQ2,
  NULL N_AREALIQ2,
  NULL NVAL2,
  NULL N_VALTOT2,
  NULL C_DESCRIPLIQ3,
  NULL N_AREALIQ3,
  NULL NVAL3,
  NULL N_VALTOT3,
  NULL C_DESCRIPLIQ4,
  NULL N_AREALIQ4,
  NULL NVAL4,
  NULL N_VALTOT4,
  NULL C_DESCRIPLIQ5,
  NULL N_AREALIQ5,
  NULL NVAL5,
  NULL N_VALTOT5,
  NULL C_DESCRIPLIQ6,
  NULL N_AREALIQ6,
  NULL NVAL6,
  NULL N_VALTOT6,
  NULL C_DESCRIPLIQ7,
  NULL N_AREALIQ7,
  NULL NVAL7,
  NULL N_VALTOT7,
  NULL C_DESCRIPLIQ8,
  NULL N_AREALIQ8,
  NULL NVAL8,
  NULL N_VALTOT8,
  NULL C_DESCRIPLIQ9,
  NULL N_AREALIQ9,
  NULL NVAL9,
  NULL N_VALTOT9,
  NULL C_DESCRIPLIQ10,
  NULL N_AREALIQ10,
  NULL NVAL10,
  NULL N_VALTOT10,
  NULL N_TOTALAVALUO,
  NULL N_VALORASEGURABLE,
  NULL R_CALIFICACION,
  PGB_OBS.T_OBSERVAVALUO,
  PGB_OBS.T_OTRASDIR,
  DECODE(PGB_AVA.A_TIPO_INFORME,2,'SI','NO') AVALUO_CONSTRUCTOR,
  PGB_AVA.T_USUARIO ID_PERITO
  --09 Abr 2014: Circular 11
  ,PGB_IC.A_RCONS_SF A_RCONS_SF_COD
  ,PGB_IC.A_DANOPREVIO_SF A_DANOPREVIO_SF_COD
  ,PGB_IC.C_ESTREFORZADA_SF C_ESTREFORZADA_SF_COD
  ,PGB_IC.A_DANOREPARADO_SF A_DANOREPARADO_SF_COD
  ,PGB_IC.SIMETRIA_ALT_SF SIMETRIA_ALT_SF_COD
  ,PGB_IC.SIMETRIA_PLANT_SF SIMETRIA_PLANT_SF_COD
  ,PGB_IC.C_MATERIAL_SF C_MATERIAL_SF_COD
  ,PGB_IC.C_DETALLEMATERIAL C_DETALLEMATERIAL_COD
  ,PGB_IF.C_USOINMUEBLE_SF C_USOINMUEBLE_SF_COD
FROM PGB_AVALUOS PGB_AVA,
     PGB_CONDSALUBRIDAD PGB_CS,
     PGB_INFBARRIO PGB_IB,
     PGB_INFCONSTRUCCION PGB_IC,
     PGB_INFINMUEBLE PGB_IF,
     PGB_OBSERVACIONES PGB_OBS
WHERE PGB_AVA.ID_AVALUO = PGB_CS.ID_AVALUO(+)
  AND PGB_CS.ID_AVALUO = PGB_IB.ID_AVALUO(+)
  AND PGB_IB.ID_AVALUO = PGB_IC.ID_AVALUO(+)
  AND PGB_IC.ID_AVALUO = PGB_IF.ID_AVALUO(+)
  AND PGB_IF.ID_AVALUO = PGB_OBS.ID_AVALUO(+)
  AND PGB_AVA.A_ESTADOAVALUO = 3
  AND PGB_AVA.ID_AVALUO NOT IN
  (select id_avaluo from pgb_liqavaluo)
/